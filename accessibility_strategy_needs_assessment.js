const pages = [
    {
        "name": "Accessibility Strategy Needs Assessment - Home",
        "type": "home",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024",
        "section-name": "",
        "section-url": ""
    },
    {
        "name": "Home",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024",
        "section-name": "Home",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "Executive Summary",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/executive-summary",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "About Accessible Services",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/about-accessible-services",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "Guiding Visions and Values",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/guiding-visions-and-values",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "Who We Serve",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/who-we-serve",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "Glossary",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/glossary",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "Streets: Capital Projects",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "1.1 Consistent Accessibility Guidance on Streets Projects",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects/11-consistent-accessibility-guidance-on-streets-projects",
        "section-name": "Streets: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects"
    },
    {
        "name": "1.2 Multi-Agency Project Coordination",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects/12-multi-agency-project-coordination",
        "section-name": "Streets: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects"
    },
    {
        "name": "1.3 Flexible and Responsive Safety Improvements",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects/13-flexible-and-responsive-safety-improvements",
        "section-name": "Streets: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects"
    },
    {
        "name": "1.4 Accessible Pedestrian Signals",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects/14-accessible-pedestrian-signals",
        "section-name": "Streets: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects"
    },
    {
        "name": "1.5 Accessible Parking and Loading",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects/15-accessible-parking-and-loading",
        "section-name": "Streets: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects"
    },
    {
        "name": "1.6 Parking and Charging of Personal Mobility Devices",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects/16-parking-and-charging-of-personal-mobility-devices",
        "section-name": "Streets: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-capital-projects"
    },
    {
        "name": "Streets: Policy and Planning",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "2.1 Accessibility-Informed Programs and Planning",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning/21-accessibility-informed-programs-and-planning",
        "section-name": "Streets: Policy and Planning",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning"
    },
    {
        "name": "2.2 Accessibility-Informed Data and Evaluations",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning/22-accessibility-informed-data-and-evaluations",
        "section-name": "Streets: Policy and Planning",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning"
    },
    {
        "name": "2.3 Accessible Emerging Private Passenger Services",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning/23-accessible-emerging-private-passenger-services",
        "section-name": "Streets: Policy and Planning",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning"
    },
    {
        "name": "2.4 Increased Adoption of Adaptive Cycling and Scooter Programs",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning/24-increased-adoption-of-adaptive-cycling-and-scooter-programs",
        "section-name": "Streets: Policy and Planning",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/streets-policy-and-planning"
    },
    {
        "name": "Muni: Capital Projects",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "3.1 Accessible Muni Vehicles",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects/31-accessible-muni-vehicles",
        "section-name": "Muni: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects"
    },
    {
        "name": "3.2 Reliable Elevators and Escalators",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects/32-reliable-elevators-and-escalators",
        "section-name": "Muni: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects"
    },
    {
        "name": "3.3 Accessible Surface Rail Stops",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects/33-accessible-surface-rail-stops",
        "section-name": "Muni: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects"
    },
    {
        "name": "3.4 Accessible Signage and Wayfinding",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects/34-accessible-signage-and-wayfinding",
        "section-name": "Muni: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects"
    },
    {
        "name": "3.5 Improved Bus Shelters",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects/35-improved-bus-stop-amenities",
        "section-name": "Muni: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects"
    },
    {
        "name": "3.6 Modified Flag Stops",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects/36-modified-flag-stops-",
        "section-name": "Muni: Capital Projects",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-capital-projects"
    },
    {
        "name": "Muni: Service Planning and Policy",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "4.1 Service Planning for Accessibility",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy/41-population-specific-travel-patterns-and-concerns-",
        "section-name": "Muni: Service Planning and Policy",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy"
    },
    {
        "name": "4.2 Affordable Muni",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy/42-affordable-muni",
        "section-name": "Muni: Service Planning and Policy",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy"
    },
    {
        "name": "4.3 Operator Training Refreshers Based Upon Customer Feedback",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy/43-operator-training-refreshers-based-upon-customer-feedback",
        "section-name": "Muni: Service Planning and Policy",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy"
    },
    {
        "name": "4.4 Accessible Communication of Service Changes and Disruptions",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy/44-accessible-communication-of-service-changes-and-disruptions",
        "section-name": "Muni: Service Planning and Policy",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy"
    },
    {
        "name": "4.5 Accessible Communication of Service Schedules and Changes",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy/45-continued-community-collaboration",
        "section-name": "Muni: Service Planning and Policy",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/muni-service-planning-and-policy"
    },
    {
        "name": "Paratransit: Mobility Management",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "5.1 Effective Travel Training Resources and Materials",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management/51-effective-travel-training-resources-and-materials",
        "section-name": "Paratransit: Mobility Management",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management"
    },
    {
        "name": "5.2 \"No-Wrong-Door\" Approach",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management/52-no-wrong-door-approach",
        "section-name": "Paratransit: Mobility Management",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management"
    },
    {
        "name": "5.3 Support Community Health",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management/53-support-community-health",
        "section-name": "Paratransit: Mobility Management",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management"
    },
    {
        "name": "5.4 Improved Engagement to Non-English Speaking Communities",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management/54-improved-engagement-to-non-english-speaking-communities",
        "section-name": "Paratransit: Mobility Management",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-mobility-management"
    },
    {
        "name": "Paratransit: Capital",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "6.1 Electric Paratransit Vehicle Procurement",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital/61-electric-paratransit-vehicle-procurement",
        "section-name": "Paratransit: Capital",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital"
    },
    {
        "name": "6.2 Permanent Paratransit Facility",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital/62-permanent-paratransit-facility",
        "section-name": "Paratransit: Capital",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital"
    },
    {
        "name": "6.3 Other Physical Technological Investments",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital/63-other-physical-technological-investments",
        "section-name": "Paratransit: Capital",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-capital"
    },
    {
        "name": "Paratransit: Financial",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "7.1 Cost-Effective Alternatives to Traditional Van Service",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial/71-cost-effective-alternatives-to-traditional-van-service",
        "section-name": "Paratransit: Financial",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial"
    },
    {
        "name": "7.2 Fare Assistance",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial/72-fare-assistance",
        "section-name": "Paratransit: Financial",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial"
    },
    {
        "name": "7.3 Clipper Payments for Paratransit Services",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial/73-clipper-payments-for-paratransit-services",
        "section-name": "Paratransit: Financial",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial"
    },
    {
        "name": "7.4 Fixed Route Fare Policy Impacts on Paratransit",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial/74-potential-changes-to-fixed-route-fare-policy",
        "section-name": "Paratransit: Financial",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-financial"
    },
    {
        "name": "Paratransit: Eligibility and Enrollment",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "8.1 Regional Eligibility Coordination Efforts",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment/81-regional-eligibility-coordination-efforts",
        "section-name": "Paratransit: Eligibility and Enrollment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment"
    },
    {
        "name": "8.2 Improved Eligibility and Enrollment Processes",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment/82-improved-eligibility-and-enrollment-processes",
        "section-name": "Paratransit: Eligibility and Enrollment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment"
    },
    {
        "name": "8.3 Services for Prospective Paratransit Applicants",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment/83-services-for-prospective-paratransit-applicants",
        "section-name": "Paratransit: Eligibility and Enrollment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment"
    },
    {
        "name": "8.4 Online Scheduling and Payment",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment/84-online-scheduling-and-payment",
        "section-name": "Paratransit: Eligibility and Enrollment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-eligibility-and-enrollment"
    },
    {
        "name": "Paratransit: Service Performance",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "9.1 Same Day Reservations and Chained Trips",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance/91-partnerships-with-other-agencies-and-providers",
        "section-name": "Paratransit: Service Performance",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance"
    },
    {
        "name": "9.2 Community Engagement and Partnerships",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance/92-community-engagement",
        "section-name": "Paratransit: Service Performance",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance"
    },
    {
        "name": "9.3 Staff and Contractor Recruitment",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance/93-staff-and-contractor-recruitment",
        "section-name": "Paratransit: Service Performance",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/paratransit-service-performance"
    },
    {
        "name": "Taxis",
        "type": "section",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis",
        "section-name": "Accessibility Strategy Needs Assessment",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024"
    },
    {
        "name": "10.1 Accessible Taxi Stands",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis/101-accessible-taxi-stands",
        "section-name": "Taxis",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis"
    },
    {
        "name": "10.2 Ramp Taxi Availability",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis/102-ramp-taxis",
        "section-name": "Taxis",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis"
    },
    {
        "name": "10.3 Accessibility-Informed Taxi Policies",
        "type": "page",
        "url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis/103-accessibility-informed-taxi-policies",
        "section-name": "Taxis",
        "section-url": "https://www.sfmta.com/accessibility-strategy-needs-assessment-2024/taxis"
    }
]

function main() {
    const currentPage = pages.find(page => page.url === window.location.href);
    const currentPageIndex = pages.findIndex(page => page.url === window.location.href);

    const findPreviousSection = (pages, startIndex) => {
        for (let i = startIndex - 1; i >= 0; i--) {
            if (pages[i].type === 'section' | pages[i].type === 'home') {
                return pages[i];
            }
        }
        return null; // Return null if no section is found
    };
    const previousSection = findPreviousSection(pages, currentPageIndex);

    const findPreviousSectionBeforeParent = (pages, startIndex) => {
        // First, find the direct parent section or home for the startIndex
        let directParentIndex = -1;
        for (let i = startIndex; i >= 0; i--) {
            if (pages[i].type === 'section' || pages[i].type === 'home') {
                directParentIndex = i;
                break; // Stop at the first section or home found
            }
        }

        // Now, find the section or home before the direct parent
        for (let i = directParentIndex - 1; i >= 0; i--) {
            if (pages[i].type === 'section' || pages[i].type === 'home') {
                return pages[i];
            }
        }

        return null; // Return null if no previous section or home is found before the parent
    };
    const previousSectionBeforeParent = findPreviousSectionBeforeParent(pages, currentPageIndex);

    const findNextSection = (pages, startIndex) => {
        for (let i = startIndex + 1; i < pages.length; i++) {
            if (pages[i].type === 'section') {
                return pages[i];
            }
        }
        return null; // Return null if no section is found
    };
    const nextSection = findNextSection(pages, currentPageIndex);

    const findPreviousPage = (pages, startIndex) => {
        for (let i = startIndex - 1; i >= 0; i--) {
            if (pages[i].type === "section") {
                return previousSectionBeforeParent;
            }
            if (pages[i].type === 'page') {
                return pages[i];
            }
            return null;
        }
    };
    const previousPage = findPreviousPage(pages, currentPageIndex);

    const findNextPage = (pages, startIndex) => {
        for (let i = startIndex + 1; i < pages.length; i++) {
            if (pages[i].type === "section") {
                return nextSection;
            }
            if (pages[i].type === 'page') {
                return pages[i];
            }
            return null;
        }
    };
    const nextPage = findNextPage(pages, currentPageIndex);

    const breadcrumbOrderedList = document.querySelector('.breadcrumb nav ol');
    if (currentPage.type === 'section') {
        const newBreadcrumbItem = document.createElement('li');
        newBreadcrumbItem.classList.add('breadcrumb-item');
        newBreadcrumbItem.innerHTML = `<a href="${currentPage['section-url']}">${currentPage['section-name']}</a>`;
        breadcrumbOrderedList.insertBefore(newBreadcrumbItem, breadcrumbOrderedList.children[1]);
    }

    if (currentPage.type === 'page') {
        const newBreadcrumbItem = document.createElement('li');
        const newHomeItem = document.createElement('li');

        newBreadcrumbItem.classList.add('breadcrumb-item');
        newHomeItem.classList.add('breadcrumb-item');

        newBreadcrumbItem.innerHTML = `<a href="${currentPage['section-url']}">${currentPage['section-name']}</a>`;
        newHomeItem.innerHTML = `<a href="${previousSection['section-url']}">${previousSection['section-name']}</a>`;

        // Insert the newBreadcrumbItem as the second item
        breadcrumbOrderedList.insertBefore(newBreadcrumbItem, breadcrumbOrderedList.children[1]);

        // If the previousSection is valid, insert newHomeItem before newBreadcrumbItem
        if (previousSection['section-url'].length > 0 && previousSection['section-name'].length > 0) {
            breadcrumbOrderedList.insertBefore(newHomeItem, breadcrumbOrderedList.children[1]);
        }
    }

    // Navigation functionality
    if (currentPage.type === 'section') {
        const regionContentDiv = document.querySelector('.block-system-main-block');
        // console.log('Region Content Div:', regionContentDiv); // Log the region content DIV

        if (!regionContentDiv.querySelector('section')) {
            // console.log('No section found on this page');
        } else {
            // console.log('Previous Section for Navigation:', previousSection); // Log previous section before using
            // console.log('Next Section for Navigation:', nextSection); // Log next section before using
            const newSection = document.createElement('section');
            newSection.innerHTML = `
        <div style="display: flex; justify-content: space-between;">
            <a href="${previousSection.url}">${previousSection.type === 'home' ? 'Home' : 'Previous Section'}</a>
            ${nextSection ? `<a href="${nextSection.url}">Next Section</a>` : ''}
        </div>
        `;
            regionContentDiv.appendChild(newSection);
        }
    }

    if (currentPage.type === 'page') {
        const nodeArticle = document.querySelector('.node');
        // console.log('Node Article:', nodeArticle); // Log the node article

        if (!nodeArticle) {
            // console.log('No article found on this page');
        } else {
            const newSection = document.createElement('section');

            newSection.innerHTML = `
            <div style="display: flex; justify-content: space-between;">
                ${previousPage ? `<a href="${previousPage.url}">${previousPage.type === 'page' ? 'Previous Page' : 'Previous Section'}</a>` : '<a href="https://www.sfmta.com/accessibility-strategy-needs-assessment-2024">Back to Home</a>'}
                ${nextPage ? `<a href="${nextPage.url}">${nextPage.type === 'page' ? 'Next Page' : 'Next Section'}</a>` : '<a href="https://www.sfmta.com/accessibility-strategy-needs-assessment-2024">Back to Home</a>'}
            </div>
        `;
            nodeArticle.appendChild(newSection);
        }
    }

    if (currentPage.type === 'page') {
        sidebar(currentPageIndex);
    }

    if (currentPage.type === 'section') {
        //
        const asideElementStatus = document.querySelector('aside');
        if (asideElementStatus) {
            sidebar(currentPageIndex);
        } else {
            // create a const that finds a div with a class row which is inside a div with class main-container which is a direct child of the body element
            const rowDiv = document.body.querySelector('div.main-container > div.row');

            // find the section element which is the child of the row div
            const sectionElement = rowDiv.querySelector('section');

            // The section element will have a class name of col-sm-12. Remove that class and add a new one: col-sm-8
            sectionElement.classList.remove('col-sm-12');
            sectionElement.classList.add('col-sm-8');

            let newAside = document.createElement('aside');
            // add the class col-sm-4 to the aside element
            newAside.classList.add('col-sm-4');
            // add the role complementary to the aside element
            newAside.setAttribute('role', 'complementary');

            let newDivItem = document.createElement('div');
            // add the two classes "region region-sidebar-second" to the newDivItem
            newDivItem.classList.add('region', 'region-sidebar-second');

            // set the innerHTML of the newAside equal to the newDivItem
            // Since you want to append the div as an element and not HTML, we'll append the newDivItem as a child
            newAside.appendChild(newDivItem);

            // Add this new aside element inside the div row as a sibling to the sectionElement. The newAside comes just after the sectionElement.
            sectionElement.insertAdjacentElement('afterend', newAside);

            setTimeout(sidebar(currentPageIndex), 25);
        }

    }

    if (currentPage.type === 'home') {
        //
        const asideElementStatus = document.querySelector('aside');
        if (asideElementStatus) {
            console.log('On home. Aside element exists');
            sidebar(currentPageIndex);
        } else {
            console.log('Aside element does not exist');
            // create a const that finds a div with a class row which is inside a div with class main-container which is a direct child of the body element
            const rowDiv = document.body.querySelector('div.main-container > div.row');

            // find the section element which is the child of the row div
            const sectionElement = rowDiv.querySelector('section');

            // The section element will have a class name of col-sm-12. Remove that class and add a new one: col-sm-8
            sectionElement.classList.remove('col-sm-12');
            sectionElement.classList.add('col-sm-8');

            let newAside = document.createElement('aside');
            // add the class col-sm-4 to the aside element
            newAside.classList.add('col-sm-4');
            // add the role complementary to the aside element
            newAside.setAttribute('role', 'complementary');

            let newDivItem = document.createElement('div');
            // add the two classes "region region-sidebar-second" to the newDivItem
            newDivItem.classList.add('region', 'region-sidebar-second');

            // set the innerHTML of the newAside equal to the newDivItem
            // Since you want to append the div as an element and not HTML, we'll append the newDivItem as a child
            newAside.appendChild(newDivItem);

            // Add this new aside element inside the div row as a sibling to the sectionElement. The newAside comes just after the sectionElement.
            sectionElement.insertAdjacentElement('afterend', newAside);

            setTimeout(sidebar(currentPageIndex), 25);
        }

    }

}

function sidebar(currentPageIndex) {
    const asideElement = document.querySelector('aside');
    // find a child DIV of this aside element. The DIV will have a class of "region region-sidebar-second"
    // remove it from the DOM

    asideElement.classList.add('col-sm-4');

    console.log('Aside Element:', asideElement);
    if (asideElement) {
        // const regionSidebarSecond = asideElement.querySelector('.region-sidebar-second');
        // find a html element with an id that starts with "block-"
        const blockElement = asideElement.querySelector('[id^="block-"]');
        if (blockElement) {
            asideElement.removeChild(blockElement);
        }
    }
    let htmlString = '';

    for (let i = 1; i < pages.length; i++) {
        // create an li element
        let li = document.createElement('li');
        let a = document.createElement('a');

        // set margin-top and margin bottom to .75rem
        li.style.marginTop = '.75rem';
        li.style.marginBottom = '.75rem';

        a.href = pages[i].url;
        a.innerHTML = pages[i].name;

        if (currentPageIndex === i) {
            a.style.textDecoration = 'underline';
        }
        if (pages[i].type === 'page') {
            li.style.marginLeft = '1rem';
        }
        // set the innerHTML of the li equal to the a element
        li.innerHTML = a.outerHTML;
        // add this li to htmlString
        htmlString += li.outerHTML;
    }

    if (asideElement) {
        const newSection = document.createElement('section');
        // add the class block to the newSection
        newSection.classList.add('block');
        newSection.innerHTML = `
                <h2 class="block-title">
                    <span id="heading-id-12iuiu42" style="color:white;font-weight: bold; text-decoration: none;"
                        href="#" onmouseover="this.style.textDecoration='none'" onmouseout="this.style.textDecoration='none'">Accessibility Strategy Needs
                        Assessment</span><br>
                    <span style="font-size: 16px;font-weight: bold;margin-top: 24px;display: block;">Table of Contents</span>
                </h2>
                <div class="view-content">
                    <ul style="list-style: none; padding-left:1rem;">
                    <li style="margin-top: 0.75rem; margin-bottom: 0.75rem; margin-left: 0rem;display: none;">Table of Contents:</li>
                    ${htmlString}
                    </ul>
                </div>
            `;
        asideElement.appendChild(newSection);
    }

    // create const with the direct parent of the aside element
    const asideParent = asideElement.parentElement;

    //add an ID to it of: custom-row-id-2376g3279
    asideParent.id = 'custom-row-id-2376g3279';

    //insert some custom css into a new <style> tag inside the <head> of the document
    const style = document.createElement('style');
    style.innerHTML = `
        #heading-id-12iuiu42 {
            color: white;
        }
        #heading-id-12iuiu42:hover {
            color: white;
            text-decoration: none;
        }

        #custom-row-id-2376g3279 main:first-of-type {
            position: relative!important;

        }
        #custom-row-id-2376g3279 aside:first-of-type {
            position: relative!important;
        }

        @media (min-width: 768px) {

            #custom-row-id-2376g3279 {
                display: flex;
                flex-wrap: wrap;
            }

            #custom-row-id-2376g3279 > .col-sm-4[role="complementary"] {
            order: -1;
            }
                
            #custom-row-id-2376g3279 > main:first-of-type {
                width: 66.6%!important;
            }
            
            #custom-row-id-2376g3279 > aside:first-of-type {
                width: 33.3%!important;
            }
            
        }

        @media (min-width: 992px) {
          }
        `
    document.head.appendChild(style);

}

// wait 1000 ms then run main function
// setTimeout(main, 200);
main();